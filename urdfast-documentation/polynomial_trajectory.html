<!doctype html><html lang="en"><head><meta charset="utf-8"><title>URDFast Documentation - polynomial_trajectory.py</title><meta name="author" content="Docapy"><link rel="stylesheet" href="style.css"></head><body><div class="navbar"><a href="index.html" class="titla"><span class="title"><span class="blue">URDFast</span> Documentation</span></a><span class="links"><a href="https://github.com/Teskann/URDFast">View Github</a><a href="https://github.com/Teskann/Docapy">About Docapy</a></span></div><h1>polynomial_trajectory.py</h1><div class="sideMenu"><span class="browse">Browse Project Files</span><a href="code_generator.html" class="menua">code_generator.py</a><a href="code_optimization.html" class="menua">code_optimization.py</a><a href="dh_params.html" class="menua">dh_params.py</a><a href="docstrings.html" class="menua">docstrings.py</a><details class="menuDetails"><summary class="menuSummary">generated</summary><details class="menuDetails"><summary class="menuSummary">Examples</summary><a href="generated/Examples/test_robot.html" class="menua">test_robot.py</a></details></details><details class="menuDetails"><summary class="menuSummary">GUI</summary><details class="menuDetails"><summary class="menuSummary">Images</summary><a href="GUI/Images/source_rc.html" class="menua">source_rc.py</a></details><a href="GUI/info_dialog.html" class="menua">info_dialog.py</a><a href="GUI/main_gui.html" class="menua">main_gui.py</a><a href="GUI/main_window.html" class="menua">main_window.py</a><a href="GUI/source_rc.html" class="menua">source_rc.py</a></details><a href="joints.html" class="menua">joints.py</a><a href="Language.html" class="menua">Language.py</a><a href="links.html" class="menua">links.py</a><span class="blue"><a href="polynomial_trajectory.html" class="menua">polynomial_trajectory.py</a></span><a href="robots.html" class="menua">robots.py</a><a href="URDF.html" class="menua">URDF.py</a><a href="urdfast.html" class="menua">urdfast.py</a></div><div class="content"><h2>File Description</h2> Trajectory Generation. All  the  functions  in this file are used to generate polynomial trajectories starting from conditions on the different derivatives.<br> This file doesn&apos;t implement functions to generate code for trajectories. Refer to code_generator.generate_polynomial_trajectory() for generation.<h2>Imports</h2></ul><h3>External Packages</h3><ul><li><a href="https://pypi.org/project/sympy" class="import">sympy</a></li></ul>If you don't have them, you can install these packages running <a href="https://pypi.org/project/pip/">pip</a> :<br><div class="code">$ <span class="blue">pip</span> install sympy<br></div><h2>Functions & Classes</h2><details><summary><span class="def">def</span> <span class="blue">get_polynomial</span>(sym_list, variable)</summary><h3>Description</h3> Get the polynomial expression from a vector of coefficients.<br><h3>Parameters</h3> <b>sym_list </b>: Iterable of SymPy symbols<div class="indent"> List of all polynomial coefficients (power ascending)</div> <b>variable</b>: SymPy Symbol<div class="indent"> Polynomial variable (is often t)<br></div><h3>Returns</h3> SymPy polynomial expression<br><h3>Example</h3><div class="code"> &gt;&gt;&gt;&nbsp;import&nbsp;sympy&nbsp;as&nbsp;sp<br> &gt;&gt;&gt;&nbsp;coefficients&nbsp;=&nbsp;sp.symbols(&quot;a0:5&quot;)<br> &gt;&gt;&gt;&nbsp;var&nbsp;=&nbsp;sp.Symbol(&quot;t&quot;)<br> &gt;&gt;&gt;&nbsp;get_polynomial(coefficients,&nbsp;var)<br> a0&nbsp;+&nbsp;a1*t&nbsp;+&nbsp;a2*t**2&nbsp;+&nbsp;a3*t**3&nbsp;+&nbsp;a4*t**4</div><br></details><details><summary><span class="def">def</span> <span class="blue">get_equations</span>(conditions, variable)</summary><h3>Description</h3> Transforming conditions to polynomial equations<br><h3>Parameters</h3> <b>conditions </b>: list of lists containing 3 elements<div class="indent"> [..., [derivative_order, time_value, equals], ...]<br> <b>derivative_order </b>: must be an integer<div class="indent"> order  of  the derivative. If the time is your derivative variable and  the  function  you  want to create describes your position, 0 corresponds to the position, 1 to the speed, 2 to the acceleration 3 to the jerk and so on.</div> <b>time_value </b>: Float or sympy.core.symbol.Symbol<div class="indent"> Time value on which you want your condition to be set</div> <b>equals </b>: Float or sympy.core.symbol.Symbol<div class="indent"> Value  of the  function for the given time. This can be a symbolic variable<br></div></div> <b>variable </b>: sympy.core.symbol.Symbol<div class="indent"> Derivative variable<br></div><h3>Returns</h3> <b>symbolic_variables </b>: tuple of sympy.core.symbol.Symbol<div class="indent"> List  of  all  symbolic  variables  noted from a0 to ak where k is the number of conditions given (the length of &apos;conditions&apos; parameter).</div> <b>der </b>: list of Sympy expressions<div class="indent"> All  polynomial  derivatives.  If the time is your derivative variable and  the  function  you want to create describes your position, der[0] will  contain  the  position  polynomial, der[1] the speed polynomial, der[2]  the  acceleration  polynomial  and  so on. The list contains k elements  where  k  is the maximum derivative order value given in the &apos;conditions&apos; parameter.</div> <b>eqns </b>: list of Sympy expressions<div class="indent"> List  containing  all  the equations. Every equation is supposed to be equal to 0 to solve the system.<br></div><h3>Example</h3><div class="code"> &gt;&gt;&gt;&nbsp;import&nbsp;sympy&nbsp;as&nbsp;sp<br> &gt;&gt;&gt;&nbsp;t,&nbsp;t0,&nbsp;tf&nbsp;=&nbsp;sp.symbols(&quot;t&nbsp;t0&nbsp;tf&quot;,&nbsp;reals=True)<br> &gt;&gt;&gt;&nbsp;cond&nbsp;=&nbsp;[[2,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2,&nbsp;tf,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;tf,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;tf,&nbsp;1]]<br> &gt;&gt;&gt;&nbsp;sym_vars,&nbsp;derivatives,&nbsp;equations&nbsp;=&nbsp;get_equations(cond,&nbsp;t)<br> &gt;&gt;&gt;&nbsp;print(sym_vars)<br> (a0,&nbsp;a1,&nbsp;a2,&nbsp;a3,&nbsp;a4,&nbsp;a5)<br> &gt;&gt;&gt;&nbsp;print(*derivatives,&nbsp;sep=&quot;\n&quot;)<br> a0&nbsp;+&nbsp;a1*t&nbsp;+&nbsp;a2*t**2&nbsp;+&nbsp;a3*t**3&nbsp;+&nbsp;a4*t**4&nbsp;+&nbsp;a5*t**5<br> a1&nbsp;+&nbsp;2*a2*t&nbsp;+&nbsp;3*a3*t**2&nbsp;+&nbsp;4*a4*t**3&nbsp;+&nbsp;5*a5*t**4<br> 2*a2&nbsp;+&nbsp;6*a3*t&nbsp;+&nbsp;12*a4*t**2&nbsp;+&nbsp;20*a5*t**3<br> &gt;&gt;&gt;&nbsp;print(*equations,&nbsp;sep=&quot;\n&quot;)<br> 2*a2&nbsp;+&nbsp;6*a3*t0&nbsp;+&nbsp;12*a4*t0**2&nbsp;+&nbsp;20*a5*t0**3<br> 2*a2&nbsp;+&nbsp;6*a3*tf&nbsp;+&nbsp;12*a4*tf**2&nbsp;+&nbsp;20*a5*tf**3<br> a1&nbsp;+&nbsp;2*a2*t0&nbsp;+&nbsp;3*a3*t0**2&nbsp;+&nbsp;4*a4*t0**3&nbsp;+&nbsp;5*a5*t0**4<br> a1&nbsp;+&nbsp;2*a2*tf&nbsp;+&nbsp;3*a3*tf**2&nbsp;+&nbsp;4*a4*tf**3&nbsp;+&nbsp;5*a5*tf**4<br> a0&nbsp;+&nbsp;a1*t0&nbsp;+&nbsp;a2*t0**2&nbsp;+&nbsp;a3*t0**3&nbsp;+&nbsp;a4*t0**4&nbsp;+&nbsp;a5*t0**5<br> a0&nbsp;+&nbsp;a1*tf&nbsp;+&nbsp;a2*tf**2&nbsp;+&nbsp;a3*tf**3&nbsp;+&nbsp;a4*tf**4&nbsp;+&nbsp;a5*tf**5&nbsp;-&nbsp;1</div><br></details><details><summary><span class="def">def</span> <span class="blue">poly_solve</span>(eqns_list, unknowns)</summary><h3>Description</h3> Custom solver for linear system of symbolic equations. As  Sympy  solve()  function gets pretty slow on not that big systems (~10 equations  and  10  unknowns  containing  symbolic variables), this solver might be faster for big systems.<br> The  most  important  feature  is that it is possible to keep track of the solving  process (printed on the console), so the user can have an idea of the remaining time.<br> This solver might however be slower if there are no symbolic variables.<br><h3>Parameters</h3> <b>eqns_list </b>: list of Sympy expressions<div class="indent"> List of expressions (considered equal to 0)</div> <b>unknowns </b>: sympy symbol list<div class="indent"> Variables to solve for<br></div><h3>Returns</h3> <b>solution </b>: dict<div class="indent"> Dictionary containing solutions<br></div></details><details><summary><span class="def">def</span> <span class="blue">get_solution</span>(equations, unknowns, derivatives)</summary><h3>Description</h3> Get the solutions to the equations to generate the trajectory.<br><h3>Parameters</h3> <b>equations </b>: list of Sympy expressions<div class="indent"> List containing all the equations to solve. Every equation must be given with its expression equal to 0<br></div> <b>unknowns </b>: tuple of sympy.core.symbol.Symbol<div class="indent"> List of all the unknowns in the equations<br></div> <b>derivatives </b>: list of Sympy expressions<div class="indent"> All  polynomial  derivatives.  If the time is your derivative variable and  the  function  you want to create describes your position, der[0] contains  the position polynomial, der[1] the speed polynomial, der[2] the acceleration polynomial and so on.<br></div><h3>Returns</h3> <b>sol </b>: list of Sympy expressions<div class="indent"> List   containing  the  expression  of  the  polynomial  and  all  its derivatives.<br></div><h3>Example</h3> Here is an example to generate a polynomial trajectory with null speed and <b>acceleration at the beginning and at the end of the trajectory </b>:<div class="indent"><ul><li> f(t0) = 0</li><li> f(tf) = 1</li><li> f&apos;(t0) = 0</li><li> f&apos;(tf) = 0</li><li> f&apos;&apos;(t0) = 0</li><li> f&apos;&apos;(tf) = 0</li></ul><br></div> In this example, t is the time variable.<br><div class="code"> &gt;&gt;&gt;&nbsp;import&nbsp;sympy&nbsp;as&nbsp;sp<br> &gt;&gt;&gt;&nbsp;t,&nbsp;t0,&nbsp;tf&nbsp;=&nbsp;sp.symbols(&quot;t&nbsp;t0&nbsp;tf&quot;,&nbsp;reals=True)<br> &gt;&gt;&gt;&nbsp;cond&nbsp;=&nbsp;[<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;tf,&nbsp;1],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;tf,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2,&nbsp;tf,&nbsp;0]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br> &gt;&gt;&gt;&nbsp;sym_vars,&nbsp;derivatives,&nbsp;equations&nbsp;=&nbsp;get_equations(cond,&nbsp;t)<br> &gt;&gt;&gt;&nbsp;sol&nbsp;=&nbsp;get_solution(equations,&nbsp;sym_vars,&nbsp;derivatives)<br> &gt;&gt;&gt;&nbsp;sp.pprint(sol[0],&nbsp;use_unicode=False)&nbsp;&nbsp;#&nbsp;Position&nbsp;(f(t))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2\<br> -(t&nbsp;-&nbsp;t0)&nbsp;*\6.0*t&nbsp;&nbsp;-&nbsp;15.0*t*tf&nbsp;+&nbsp;t0&nbsp;&nbsp;+&nbsp;t0*(3.0*t&nbsp;-&nbsp;5.0*tf)&nbsp;+&nbsp;10.0*tf&nbsp;/<br> -----------------------------------------------------------------------<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(t0&nbsp;-&nbsp;tf)<br> &gt;&gt;&gt;&nbsp;sp.pprint(sol[1],&nbsp;use_unicode=False)&nbsp;&nbsp;#&nbsp;Speed&nbsp;&nbsp;(f&apos;(t))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br> -30.0*(t&nbsp;-&nbsp;t0)&nbsp;*(t&nbsp;-&nbsp;tf)<br> --------------------------<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(t0&nbsp;-&nbsp;tf)<br> &gt;&gt;&gt;&nbsp;sp.pprint(sol[2],&nbsp;use_unicode=False)&nbsp;&nbsp;#&nbsp;Acceleration&nbsp;(f&apos;&apos;(t))<br> -60.0*(t&nbsp;-&nbsp;t0)*(t&nbsp;-&nbsp;tf)*(2.0*t&nbsp;-&nbsp;t0&nbsp;-&nbsp;tf)<br> ------------------------------------------<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(t0&nbsp;-&nbsp;tf)</div></details><details><summary><span class="def">def</span> <span class="blue">verify_solution</span>(conditions, solution, function_variable)</summary><h3>Description</h3> Verifies that the found solution is actually correct, ie that the solution follows the desired conditions.<br> This function also verifies that the derivatives are actually correct.<br><h3>Parameters</h3> <b>conditions </b>: list of lists containing 3 elements<div class="indent"> [..., [derivative_order, time_value, equals], ...]<br> <b>derivative_order </b>: must be an integer<div class="indent"> order  of  the derivative. If the time is your derivative variable and  the  function  you  want to create describes your position, 0 corresponds to the position, 1 to the speed, 2 to the acceleration 3 to the jerk and so on.</div> <b>time_value </b>: Float or sympy.core.symbol.Symbol<div class="indent"> Time value on which you want your condition to be set</div> <b>equals </b>: Float or sympy.core.symbol.Symbol<div class="indent"> Value  of the  function for the given time. This can be a symbolic variable</div></div> <b>solution </b>: list of Sympy expressions<div class="indent"> All  polynomial  derivatives.  If the time is your derivative variable and  the  function  you want to create describes your position, der[0] contains  the position polynomial, der[1] the speed polynomial, der[2] the acceleration polynomial and so on.</div> <b>function_variable </b>: sympy.core.symbol.Symbol<div class="indent"> Function variable (often t for time-based polynomials)<br></div><h3>Returns</h3> <b>Boolean </b>:<div class="indent"> True if the solution is correct, False else.<br></div><h3>Examples</h3><div class="code"> &gt;&gt;&gt;&nbsp;import&nbsp;sympy&nbsp;as&nbsp;sp<br> &gt;&gt;&gt;&nbsp;t,&nbsp;t0,&nbsp;tf&nbsp;=&nbsp;sp.symbols(&quot;t&nbsp;t0&nbsp;tf&quot;,&nbsp;reals=True)<br> &gt;&gt;&gt;&nbsp;cond&nbsp;=&nbsp;[<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;tf,&nbsp;1],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;tf,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2,&nbsp;t0,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2,&nbsp;tf,&nbsp;0],<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br> &gt;&gt;&gt;&nbsp;sym_vars,&nbsp;derivatives,&nbsp;equations&nbsp;=&nbsp;get_equations(cond,&nbsp;t)<br> &gt;&gt;&gt;&nbsp;sol&nbsp;=&nbsp;get_solution(equations,&nbsp;sym_vars,&nbsp;derivatives)<br> &gt;&gt;&gt;&nbsp;verify_solution(cond,&nbsp;sol,&nbsp;t)<br> True</div><br></details></details></div></body></html>