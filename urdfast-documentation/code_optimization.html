<!doctype html><html lang="en"><head><meta charset="utf-8"><title>URDFast Documentation - code_optimization.py</title><meta name="author" content="Docapy"><link rel="stylesheet" href="style.css"></head><body><div class="navbar"><a href="index.html" class="titla"><span class="title"><span class="blue">URDFast</span> Documentation</span></a><span class="links"><a href="https://github.com/Teskann/URDFast">View Github</a><a href="https://github.com/Teskann/Docapy">About Docapy</a></span></div><h1>code_optimization.py</h1><div class="sideMenu"><span class="browse">Browse Project Files</span><a href="code_generator.html" class="menua">code_generator.py</a><span class="blue"><a href="code_optimization.html" class="menua">code_optimization.py</a></span><a href="createRobotFromURFD.html" class="menua">createRobotFromURFD.py</a><a href="Language.html" class="menua">Language.py</a><a href="URDF.html" class="menua">URDF.py</a><a href="urdfast.html" class="menua">urdfast.py</a><details class="menuDetails"><summary class="menuSummary">generated</summary><details class="menuDetails"><summary class="menuSummary">Examples</summary><a href="generated/Examples/test_robot.html" class="menua">test_robot.py</a></details></details><details class="menuDetails"><summary class="menuSummary">GUI</summary><a href="GUI/info_dialog.html" class="menua">info_dialog.py</a><a href="GUI/main_gui.html" class="menua">main_gui.py</a><a href="GUI/main_window.html" class="menua">main_window.py</a><a href="GUI/source_rc.html" class="menua">source_rc.py</a><details class="menuDetails"><summary class="menuSummary">Images</summary><a href="GUI/Images/source_rc.html" class="menua">source_rc.py</a></details></details></div><div class="content"><h2>File Description</h2> <b>Created on Sat Jun 20 14</b>:50:36 2020<br> <b>@author</b>: Cl√©ment<h2>Imports</h2></ul><h3>Standard Packages</h3><ul><li><a href="https://docs.python.org/3/library/re.html" class="import">re</a></li></ul><h3>External Packages</h3><ul><li><a href="https://pypi.org/project/anytree" class="import">anytree</a></li></ul>If you don't have them, you can install these packages running <a href="https://pypi.org/project/pip/">pip</a> :<br><div class="code">$ <span class="blue">pip</span> install anytree<br></div><h2>Functions & Classes</h2><details><summary><span class="def">def</span> <span class="blue">same_precedence_opers</span>(op)</summary><h3>Description</h3> Returns the list of all the operators having the same precedence as op<br><h3>Parameters</h3> <b>op </b>: str<div class="indent"> String od the operator<br></div><h3>Returns</h3> <b>list of str</b>:<div class="indent"> list of string containing all operators with the same precedence<br></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">higher_priority_oper</span>(op)</summary><h3>Description</h3> Returns  all  the  operators  that  have  a  higher  priority than the operator op.<br> Result is returned as a list with priority descending<br><h3>Parameters</h3> <b>op </b>: str<div class="indent"> String of the Python operator<br></div><h3>Returns</h3> <b>list </b>: list of str<div class="indent"> List of strings containing operators having a higher priority level than the operator op<br></div><h3>Examples</h3> TODO</details><details><summary><span class="def">def</span> <span class="blue">catch_operator</span>(string, operator)</summary><h3>Description</h3> Catches the whole sequence around an operator or inside a function string.<br> Returns  a  list  containing  one list per match. Every sublist contains a tuple  containing  the beginning index and the end index of the operand so <b>that string[beginning</b>:end] matches exactly the operand.<br><h3>Parameters</h3> <b>string </b>: str<div class="indent"> String in which one you want to catch operator<br></div> <b>operator </b>: str<div class="indent"> operator to look for<br></div><h3>Returns</h3> List of list of tuple with 2 elements<div class="indent"> Returns a list containing one list per match. Every sublist contains a tuple containing  the beginning index and the end index of the operand <b>so that string[beginning</b>:end] matches exactly the operand.<br></div><h3>Examples</h3> TODO !!!<h3>Nested Functions</h3><details><summary><span class="def">def</span> <span class="blue">check_unary</span>(string, index)</summary><h3>Description</h3> Checks if the operator at the char i of the string is unary or binary.<br> An operator is considered as unary  if and only if the first non-space character on its left is an operator,  an  openning bracket, a coma or nothing.<br><h3>Parameters</h3> <b>string </b>: str<div class="indent"> String containing a mathematical function</div> <b>index </b>: int<div class="indent"> String index where the operator is located<br></div><h3>Returns</h3> <b>str </b>:<div class="indent"> String  of  the operator followed by &apos;u&apos; if the operator is unary, operator else.<br></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">find_whole_operator</span>(string, index, forward=True)</summary><h3>Description</h3> Returns  the  whole operator which at least one char is located at the char &apos;index&apos; in the string &apos;string&apos;<br><h3>Parameters</h3> <b>string </b>: str<div class="indent"> String representing a mathematical function containing operators.</div> <b>index </b>: int<div class="indent"> String index where a char of an operator is located</div> <b>forward </b>: bool, optional<div class="indent"> If true, looks for the rest of the operator forward, else backward The default is True.<br></div><h3>Returns</h3> str<div class="indent"> String containing the whole operator<br></div><h3>Examples</h3> TODO<br></details></details><details><summary><span class="def">def</span> <span class="blue">find_all_functions</span>(string, char='(')</summary><h3>Description</h3> Finds all the function calls in the string. Functions calls are defined by a word character (\w) followed by an openning parenthesis.<br><h3>Parameter</h3> <b>string </b>: str<div class="indent"> String containing a mathematical function<br></div> <b>char </b>: str, optional default is &apos;(&apos;<div class="indent"> &apos;(&apos; for functions, &apos;[&apos; for lists<br></div><h3>Returns</h3> <b>set of str </b>:<div class="indent"> Set containing all the names of the functions called in the string<br></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">catch_function</span>(string, func_name, char='(')</summary><h3>Description</h3> Returns all the occurences of the &apos;func_name&apos; function calls in the string<br><h3>Parameters</h3> <b>string </b>: str<div class="indent"> String  of  the  mathematical  function in which you want to catch the function</div> <b>func_name </b>: str<div class="indent"> Name of the function you want to catch</div> <b>char </b>: str, optional, default is &apos;(&apos;<div class="indent"> &apos;(&apos; for functions, &apos;[&apos; for lists subscriptions<br></div><h3>Returns</h3> <b>list of list of tuple of int </b>:<div class="indent"> <b>List of int containing all the function calls </b>:<div class="indent"> [[(beg_arg_0_0, end_arg_0_0), ... (beg_arg_k_0, end_arg_k_0))]<div class="indent"><div class="indent"><div class="indent"> . . For m function calls .</div></div></div> [(beg_arg_0_n, end_arg_0_n), ... (beg_arg_k_n, end_arg_k_n))]<br></div></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">find_all_lists</span>(string)</summary><h3>Description</h3> Finds all the lists operations with the operator []<br><h3>Parameter</h3> <b>string </b>: str<div class="indent"> String containing a mathematical function<br></div><h3>Returns</h3> <b>list of list of tuple of int </b>:<div class="indent"> <b>List of int containing all the lists </b>:<div class="indent"> [[(beg_arg_0_0, end_arg_0_0), ... (beg_arg_k_0, end_arg_k_0))]<div class="indent"><div class="indent"><div class="indent"> . . For m list operations .</div></div></div> [(beg_arg_0_n, end_arg_0_n), ... (beg_arg_k_n, end_arg_k_n))]<br></div></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">find_everything</span>(string)</summary><h3>Description</h3> Returns all the operations in the string<br><h3>Parameter</h3> <b>string </b>: str<div class="indent"> Mathematical expression<br></div><h3>Returns</h3> <b>list of dict </b>:<div class="indent"> List of all the operations in the same order than the tree list. <b>Every dict is formatted like this </b>:<div class="indent"> <b>&apos;operator&apos; </b>: operator string or function name <b>&apos;operation&apos; </b>: dict formatted like this :<div class="indent"> <b>&apos;indices&apos; </b>: list of tuple containing the beginning and the end indices  of  all  the  operands / arguments of the operation / function <b>&apos;str_val&apos; </b>: string value of the arguments / operands <b>&apos;len&apos; </b>: length of the operation</div> <b>&apos;is_fct&apos; </b>: True if it is a funciton, false if it&apos;s an operator<br></div></div></details><details><summary><span class="def">def</span> <span class="blue">get_tree</span>(operations_list)</summary><h3>Description</h3> Create  the  operations  /  functions  call  tree  from  a list of dift of operations<br><h3>Parameter</h3> <b>operations_list </b>: list of dict<div class="indent"> List of all the operations from whiches you want to create the tree. <b>Every dict is formatted like this </b>:<div class="indent"> <b>&apos;operator&apos; </b>: operator string or function name <b>&apos;operation&apos; </b>: dict formatted like this :<div class="indent"> <b>&apos;indices&apos; </b>: list of tuple containing the beginning and the end indices  of  all  the  operands / arguments of the operation / function <b>&apos;str_val&apos; </b>: string value of the arguments / operands <b>&apos;len&apos; </b>: length of the operation</div> <b>&apos;is_fct&apos; </b>: True if it is a funciton, false if it&apos;s an operator<br></div></div><h3>Returns</h3> list of anytree.node.node.Node<div class="indent"> List of all Nodes of operations (linked)</div><h3>Nested Functions</h3><details><summary><span class="def">def</span> <span class="blue">find_leaf</span>(min_index, max_index, exclude_op, general=False)</summary><h3>Description</h3> Returns the index of the leaf  operation between the indices min_index and max_index<br><h3>Parameters</h3> <b>min_index </b>: int<div class="indent"> Minimum index</div> <b>max_index </b>: int<div class="indent"> Maximum index</div> <b>exclude_op </b>: int<div class="indent"> Index of the operation you want to ignore</div> <b>general </b>: bool<div class="indent"> If True, the three above arguments are ignored Default is False<br></div><h3>Returns</h3> Index of the leave (longest) operation between the 2 indices None if there is no leaf<br><h3>Global Variables Used</h3><ul><li> operations_list</li></ul><br></details></details><details><summary><span class="def">def</span> <span class="blue">render</span>(operation_dict, parentheses=False)</summary><h3>Description</h3> Converts the operation dict to the string representation<br><h3>Parameter</h3> <b>operation_dict </b>: dict<div class="indent"> Operation you want to convert to string <b>Every dict is formatted like this </b>:<div class="indent"> <b>&apos;operator&apos; </b>: operator string or function name <b>&apos;operation&apos; </b>: dict formatted like this :<div class="indent"> <b>&apos;indices&apos; </b>: list of tuple containing the beginning and the end indices  of  all  the  operands / arguments of the operation / function <b>&apos;str_val&apos; </b>: string value of the arguments / operands <b>&apos;len&apos; </b>: length of the operation</div> <b>&apos;is_fct&apos; </b>: True if it is a funciton, false if it&apos;s an operator<br></div></div><h3>Returns</h3> str<div class="indent"> String representation of the operation</div> <b>parentheses </b>: bool, optional<div class="indent"> If True, add parentheses around the expression. Default is False<br></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">render_from_tree</span>(tree, all_op)</summary><h3>Description</h3> Render the whole expression from a tree representation<br><h3>Parameters</h3> <b>tree </b>: list of anytree.node.node.Node<div class="indent"> List of all Nodes of operations (linked)<br></div> <b>all_op </b>: list of dict<div class="indent"> List of all the operations in the same order than the tree list. <b>Every dict is formatted like this </b>:<div class="indent"> <b>&apos;operator&apos; </b>: operator string or function name <b>&apos;operation&apos; </b>: dict formatted like this :<div class="indent"> <b>&apos;indices&apos; </b>: list of tuple containing the beginning and the end indices  of  all  the  operands / arguments of the operation / function <b>&apos;str_val&apos; </b>: string value of the arguments / operands <b>&apos;len&apos; </b>: length of the operation</div> <b>&apos;is_fct&apos; </b>: True if it is a funciton, false if it&apos;s an operator<br></div></div><h3>Returns</h3> <b>str </b>:<div class="indent"> String expression of the tree representation<br></div><h3>Nested Functions</h3><details><summary><span class="def">def</span> <span class="blue">copy</span>(old)</summary>No documentation found for this section</details><details><summary><span class="def">def</span> <span class="blue">recursive_render</span>(index)</summary>No documentation found for this section</details></details><details><summary><span class="def">def</span> <span class="blue">replace</span>(string, operator, new_operator)</summary><h3>Description</h3> Replace  an  operator  /  function  in an expression by another operator / function in the string.  May  be  useful  to  convert an expression from a language to another.<br><h3>Parameters</h3> <b>string </b>: str<div class="indent"> String representing a mathematical expression<br></div> <b>operator </b>: list<div class="indent"> Operator / function you want to replace <b>List that contains </b>:<div class="indent"><ul><li> At index 0 =&gt; operator string value</li><li> At index 1 =&gt; bool set to true if it is a function</li></ul></div></div> <b>new_operator </b>: list<div class="indent"> New value of the function / operation <b>List that contains </b>:<div class="indent"><ul><li> At index 0 =&gt; operator string value</li><li> At index 1 =&gt; bool set to true if it is a function</li></ul><br></div></div><h3>Returns</h3> <b>str </b>:<div class="indent"> Copy of the string with the substitution done<br></div><h3>Examples</h3> TODO<br></details><details><summary><span class="def">def</span> <span class="blue">replace_var</span>(string, var, new_var)</summary><h3>Description</h3> Replace a variable by another variable or expression<br><h3>Parameters</h3> <b>string </b>: str<div class="indent"> Mathematical expression string</div> <b>var </b>: str<div class="indent"> Variable you want to replace</div> <b>new_var </b>: str<div class="indent"> New value of the replaced variable<br></div><h3>Returns</h3> <b>str </b>:<div class="indent"> Value of the new mathematical expression<br></div></details><details><summary><span class="def">def</span> <span class="blue">optimize</span>(string)</summary><h3>Description</h3> Optimize a string function finding redundant operations. Returns all intermediate variables and the simplified expression<br> <b>Function only supports operators </b>:<div class="indent"><ul><li> +</li><li> -</li><li> *</li><li> /</li><li> **</li></ul></div> and every function call with eventually many parameters.<br><h3>Parameter</h3> <b>string </b>: str<div class="indent"> String representing a mathematical expression<br></div><h3>Returns</h3> <b>variables </b>: list of dict of strings<div class="indent"> List containing the definition of every variable <b>Every element of this list is a dict containing keys </b>:<div class="indent"><ul><li> <b>&apos;name&apos; (str) </b>: variable name</li><li> <b>&apos;value&apos; (str) </b>: value of this variable</li></ul></div></div> <b>expression </b>: str<div class="indent"> New expression of the function string<br></div><h3>Examples</h3> TODO<br><h3>Nested Functions</h3><details><summary><span class="def">def</span> <span class="blue">copy</span>(old)</summary>No documentation found for this section</details><details><summary><span class="def">def</span> <span class="blue">new_name</span>(var_operator)</summary><h3>Description</h3> Get a name for a variable which is not already used<br><h3>Parameter</h3> <b>var_operator </b>: str<div class="indent"> Operator or function of the variable expression<br></div><h3>Returns</h3> str<div class="indent"> Variable name</div></details></details></div></body></html>